---
import ReportLayout from '../layouts/ReportLayout.astro';
import Header from '../components/Header.astro';
import Introduccion from '../components/Introduccion.astro';
import BrechaDigital from '../components/BrechaDigital.astro';
import MadurezDigital from '../components/MadurezDigital.astro';
import CompetenciasDigitales from '../components/CompetenciasDigitales.astro';
import UsoInteligenciaArtificial from '../components/UsoInteligenciaArtificial.astro';
import CulturaOrganizacional from '../components/CulturaOrganizacional.astro';
import PlanAccion from '../components/PlanAccion.astro';
import ResumenEjecutivo from '../components/ResumenEjecutivo.astro';
import Footer from '../components/Footer.astro';
import Divider from '../components/Divider.astro';
import { promises as fs } from 'fs';
import path from 'path';

export async function getStaticPaths() {
  const dataDir = path.resolve(process.cwd(), 'src/data');
  const files = await fs.readdir(dataDir);

  const paths = files
    .filter(file => file.startsWith('globalData.') && file.endsWith('.json') && file !== 'globalData.json')
    .map(file => {
      const report = file.replace('globalData.', '').replace('.json', '');
      return { params: { report } };
    });

  return paths;
}

const { report } = Astro.params;
const globalData = await import(`../data/globalData.${report}.json`);


---
<ReportLayout title="Reporte de TransformaciÃ³n Digital Organizacional - Profermaco">
  <Header 
    empresa={globalData.header.empresa}
    fechaDiagnostico={globalData.header.fechaDiagnostico}
    empleadosEvaluados={globalData.header.empleadosEvaluados}
    titulo={globalData.header.titulo}
  />

  <div class="container">
    <Introduccion
      titulo={globalData.introduccion.titulo}
      contenido={globalData.introduccion.contenido}
    />

    <Divider />

    <BrechaDigital 
      titulo={globalData.brechaDigital.titulo}
      puntuacionEmpresa={globalData.brechaDigital.puntuacionEmpresa}
      puntuacionPromedioSector={globalData.brechaDigital.puntuacionPromedioSector}
      puntuacionMetaSector={globalData.brechaDigital.puntuacionMetaSector}
      textoNivelActual={globalData.brechaDigital.textoNivelActual}
      nombreEmpresa={globalData.brechaDigital.nombreEmpresa}
      textoOportunidadParrafo={globalData.brechaDigital.textoOportunidadParrafo}
      parrafo1={globalData.brechaDigital.parrafo1}
      parrafo2={globalData.brechaDigital.parrafo2}
    />

    <Divider />

    <MadurezDigital
      titulo={globalData.madurezDigital.titulo}
      puntuacionGeneral={globalData.madurezDigital.puntuacionGeneral}
      puntuacionPromedioSector={globalData.madurezDigital.puntuacionPromedioSector}
      puntuacionMetaSector={globalData.madurezDigital.puntuacionMetaSector}
      nombreEmpresa={globalData.madurezDigital.nombreEmpresa}
      parrafoIntroductorio={globalData.madurezDigital.parrafoIntroductorio}
      componentes={globalData.madurezDigital.componentes}
    />

    <Divider />

    <CompetenciasDigitales
      titulo={globalData.competenciasDigitales.titulo}
      promedio={globalData.competenciasDigitales.promedio}
      descripcionPromedio={globalData.competenciasDigitales.descripcionPromedio}
      nivelDesarrollo={globalData.competenciasDigitales.nivelDesarrollo}
      datosGrafico={globalData.competenciasDigitales.competencias}
    />

    <Divider />

    <UsoInteligenciaArtificial
      titulo={globalData.usoInteligenciaArtificial.titulo}
      graficos={globalData.usoInteligenciaArtificial.graficos}
      resumen={globalData.usoInteligenciaArtificial.resumen}
    />

    <Divider />

    <CulturaOrganizacional
      titulo={globalData.culturaOrganizacional.titulo}
      tarjetas={globalData.culturaOrganizacional.tarjetas}
      insights={globalData.culturaOrganizacional.insights}
    />

    <Divider />

    <PlanAccion
      titulo={globalData.planAccion.titulo}
      resumen={globalData.planAccion.resumen}
      metricasResumen={globalData.planAccion.metricasResumen}
      tracker={globalData.planAccion.tracker}
      roadmap={globalData.planAccion.roadmap}
      beneficios={globalData.planAccion.beneficios}
    />

    <Divider />

    <ResumenEjecutivo
      titulo={globalData.resumenEjecutivo.titulo}
      resumenGeneral={globalData.resumenEjecutivo.resumenGeneral}
      puntuacionesDimensiones={globalData.resumenEjecutivo.puntuacionesDimensiones}
      puntuacionGeneral={globalData.resumenEjecutivo.puntuacionGeneral}
      fortalezas={globalData.resumenEjecutivo.fortalezas}
      oportunidades={globalData.resumenEjecutivo.oportunidades}
    />
  </div>

  <Footer
    anio={globalData.footer.anio}
    texto={globalData.footer.texto}
  />
</html>