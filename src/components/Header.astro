---
import "../styles/global.css";

const {
    empresa = "Profermaco",
    fechaDiagnostico = "Lunes 9 de junio de 2025",
    empleadosEvaluados = "22",
    titulo = "Reporte de Transformaci칩n Digital Organizacional",
    generatedAt,
    provider,
    model,
    generationMode
} = Astro.props;

const reports = await Astro.glob('../data/globalData.*.json');
const providers = reports.map(report => report.header.provider);

// Preferir la marca de tiempo precisa de generaci칩n si est치 disponible
const fechaMostrada = generatedAt
  ? new Date(generatedAt).toLocaleString('es-ES', { dateStyle: 'full', timeStyle: 'short' })
  : fechaDiagnostico;
---
<header>
    <div class="container header-container">
        <div class="logo-container">
            <div class="logo">skilt<span class="dot">.</span></div>
        </div>
        <div class="header-meta">
            <div class="meta-item">
                <span class="meta-label">Empresa:</span>
                <span>{empresa}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Fecha del Diagn칩stico:</span>
                <span>{fechaMostrada}</span>
            </div>
            <div class="meta-item">
                <span class="meta-label">Empleados Evaluados:</span>
                <span>{empleadosEvaluados}</span>
            </div>
            {(provider || model || generationMode) && (
              <div class="meta-item">
                <span class="meta-label">Motor:</span>
                <span class="badge provider">{provider}</span>
                {model && <span class="badge model">{model}</span>}
                {generationMode && <span class={`badge mode ${generationMode}`}>{generationMode}</span>}
              </div>
            )}
        </div>
    </div>
    <nav class="container">
      <ul class="flex gap-4">
        {providers.map(provider => (
          <li ><a href={`/${provider}`} class="text-primary hover:underline">{provider}</a></li>
        ))}
      </ul>
    </nav>
    <div class="container">
      <h1>{titulo}</h1>
    </div>
</header>

<style>
  .badge { display:inline-block; margin-left:.5rem; padding:.15rem .5rem; border-radius:999px; font-size:.75rem; background:#e5e7eb; color:#0f172a; }
  .badge.provider { background:#e0f2fe; color:#075985; }
  .badge.model { background:#ede9fe; color:#5b21b6; }
  .badge.mode { background:#ecfeff; color:#134e4a; text-transform: capitalize; }
  .badge.mode.offline { background:#fef3c7; color:#92400e; }
  .badge.mode.online-degraded { background:#fee2e2; color:#991b1b; }
</style>
