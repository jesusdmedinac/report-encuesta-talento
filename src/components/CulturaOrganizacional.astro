---
import { ClassByLevel, scoreToScaleDecile } from "../utils/utils";

const {
    titulo = "Cultura Organizacional",
    tarjetas = [
    ],
    insights = {
        titulo: "üí° Insights Clave de Cultura Organizacional",
        puntos: [
            { icono: "üèóÔ∏è", texto: "<strong>Base s√≥lida:</strong> Apertura tecnol√≥gica en primera etapa (2.0/10)" },
            { icono: "üéì", texto: "<strong>Gran oportunidad:</strong> Formaci√≥n digital estructurada (1.8/10)" },
            { icono: "üéØ", texto: "<strong>Liderazgo preparado:</strong> Visi√≥n digital en desarrollo (2.0/10)" }
        ],
        resumen: "La cultura organizacional de Profermaco est√° en la primera etapa de desarrollo digital, con fundamentos s√≥lidos y excelentes oportunidades de crecimiento. La organizaci√≥n est√° perfectamente posicionada para una transformaci√≥n cultural gradual que incluya programas de capacitaci√≥n espec√≠ficos para el sector ferretero, fortalecimiento del liderazgo digital y desarrollo de procesos sistematizados para la adopci√≥n tecnol√≥gica organizacional."
    }
} = Astro.props;

const tarjetasWithScaleDeciles = tarjetas.map((tarjeta: any) => ({
  ...tarjeta,
  scaleDecile: scoreToScaleDecile(tarjeta.puntuacion, "culturaOrganizacional")
}))
---
<style>
  .badge { border-radius: 999px; }
  .lvl-low { padding: 0.12rem 0.5rem; background: #fee2e2; color: #7f1d1d; }
  .lvl-mid { padding: 0.12rem 0.5rem; background: #fef3c7; color: #78350f; }
  .lvl-high { padding: 0.12rem 0.5rem; background: #dcfce7; color: #14532d; }
</style>
<section>
    <h2>{titulo}</h2>
    
    <div class="culture-dashboard">
        {tarjetasWithScaleDeciles.map((tarjeta: any) => (
            <div class="culture-card">
                <div class="culture-header">
                    <div class="culture-icon" style={`background: ${tarjeta.colorIcono};`} set:html={tarjeta.icono} />
                    <div class="culture-title-section">
                        <h3 style="margin: 0;">{tarjeta.titulo}</h3>
                        <div class="culture-score">{tarjeta.scaleDecile?.puntaje || 0}</div>
                    </div>
                    <div class:list={[ClassByLevel[tarjeta.scaleDecile?.nivel || "Inicial"], "badge"]}>{tarjeta.scaleDecile?.nivel || "Inicial"}</div>
                </div>
                
                <div class="culture-narrative">
                    <div class="key-phrase">"{tarjeta.fraseClave}"</div>
                    <p>{tarjeta.narrativa}</p>
                </div>
            </div>
        ))}
    </div>
    
    <div class="culture-insights" style="background: linear-gradient(135deg, rgba(37, 99, 235, 0.05), rgba(37, 99, 235, 0.02)); border-radius: 12px; padding: 25px; margin-top: 30px; border-left: 4px solid var(--color-company);">
        <h4 style="color: var(--color-company); margin-bottom: 15px; font-size: 1.1rem;">{insights.titulo}</h4>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 20px; margin-bottom: 15px;">
            {insights.puntos.map((punto: any) => (
                <div style="display: flex; align-items: center; gap: 10px;">
                    <span style="font-size: 1.5rem;">{punto.icono}</span>
                    <span set:html={punto.texto} />
                </div>
            ))}
        </div>
        <p style="margin: 0; font-size: 0.95rem; line-height: 1.6; color: var(--text-primary);">
            {insights.resumen}
        </p>
    </div>
</section>
